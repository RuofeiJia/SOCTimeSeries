## Introduction
This repository contains the complete data and code for the manuscript “A large global soil carbon sink informed by repeated soil samplings”.
This manuscript has been posted as a preprint on BioRxiv (ID: BIORXIV/2025/650716).

It contains all the data and scripts necessary to replicate the results presented in the main text and all figures and tables.

Large files such as spatial data and intermediate results are not saved in this repository due to storage space limitations, but they can be generated by running the scripts included.

All scripts were run in R Version 4.3.2


## “data” folder contains

- region_division_df.rda
	- Dataframe with region division modified from Pan et al. (2024). It was used to generate proportion_decade_df.rda
 	- Each row contains centered latitude, centered longitude, and the region name of a 0.5 degree pixel.

- SOC_time_series_database.rda
	- The complete database of SOC time series without processing and cleaning. It is generated in 01_process_input_data.R
	- Description in SOC_time_series_database_metadata.csv

- SOC_time_series_for_analysis.rda
	- Processed dataset used for analysis of this manuscript
	- Description in SOC_time_series_for_analysis_metadata.csv

- Other files not included in this repository can be generated by running 00_download_prepare_spatial_data.R and 01_process_input_data.R in order

## “results” folder contains

- TRENDY_v12_global_cSoil_S2_20250114.csv
	- Estimates of global soil C stock during 1770-2023 from individual models of TRENDYv12 (S2 simulation).
	- Code that generated these results are available at https://github.com/yinonbaron/SOC_change_TRENDYv12/tree/main

- SOC_change_table.xlsx
	- All main and supplementary tables generated from script Tables_all.R
	- It also contains data used to visualize Fig. 3C

- Other files not included in this repository can be generated by running 02_analysis.R, 03_prediction.R, and 04_upscale.R in order, after running 00_download_prepare_spatial_data.R and 01_process_input_data.R to recover files in the "data" folder.

## “scripts” folder contains
- 00_download_prepare_spatial_data.R
	- Script used to download and process all spatial data

- 01_process_input_data.R
	- Script that processes the raw database (SOC_time_series_database.rda) into dataset ready for statistical analysis (SOC_time_series_for_analysis.rda)
	- Outputs “SOC_time_series_for_analysis.rda”

- 02_analysis.R
	- The first half of the script conducts a Wilcoxon test on the soil C rate of change between young and old forests
	- The second half of the script fits the Bayesian GAMM model to the available SOC time series in SOC_time_series_for_analysis.rda
	- Outputs “gamm_brms12.rda”

- 03_prediction.R
	- Script that uses the GAMM to predict SOC change per area at pixel level during 1992-2000, 2000-2010, 2010-2020, and 1992-2020
	- Outputs “prediction_result.rda” (unsaved), “prediction_inputs.rda”

- 04_upscale.R
	- The first half of the script upscales pixel-level predictions into regional and global estimates of SOC changes.
	- The second half of the script used the upscaled results to estimate forest SOC sink (shown in Fig. 3B), SLAND_soil (shown in Table 2), and natural SOC sink excluding tropical forests and boreal grasslands (mentioned in “Evaluating global estimates”)
	- Outputs “upscaled_regional_summary.RData”, “upscaled_regional_predictions.RData”, “upscaled_pixel_summary.RData”

- Figure1.R, Figure2.R, Figure3.R, Figures_supplementary
	- Scripts that generate main and supplementary figures

- Tables_all.R
	- Script that generates all main and supplementary tables

